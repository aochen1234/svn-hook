{% extends "base.html" %}
{% block title %}Domain Cookie Display{% endblock %}
{% block welcome %}{{ user }}{% endblock %}
{% block name %}{{ user }}{% endblock %}
{% load mytags %}
{% block menu %}
    <ul class="sidebar-nav">
					<li class="sidebar-nav-link">
						<a href="{% url "index" %}">
							<i class="am-icon-home sidebar-nav-link-logo"></i> 首页
						</a>
					</li>
					<li class="sidebar-nav-link">
						<a href="{% url 'result_dis' %}" class="active">
							<i class="am-icon-clone sidebar-nav-link-logo"></i> 检测结果查看
							<span class="am-badge am-badge-secondary sidebar-nav-link-logo-ico am-round am-fr am-margin-right-sm"></span>
						</a>
					</li>
					<li class="sidebar-nav-link">
						<a href="{% url "source_set" %}">
							<i class="am-icon-table sidebar-nav-link-logo"></i> 检测来源设置
						</a>
					</li>
					<li class="sidebar-nav-link">
						<a href="{% url "testrule" %}">
							<i class="am-icon-calendar sidebar-nav-link-logo"></i> 检测规则设置
						</a>
					</li>
					<li class="sidebar-nav-link">
						<a href="{% url "speed" %}" >
							<i class="am-icon-calendar sidebar-nav-link-logo"></i> 检测批数设置
						</a>
					</li>
                    <li class="sidebar-nav-link">
						<a href="{% url "resexport" %}" >
							<i class="am-icon-calendar sidebar-nav-link-logo"></i> 检测结果导出
						</a>
					</li>
                    <li class="sidebar-nav-heading"></li>
                    <li class="sidebar-nav-link">
                    </li>
			</div>
        </ul>
{% endblock %}
            {% block content %}
			<!-- 内容区域 -->

			<div class="tpl-content-wrapper">

				<div class="container-fluid am-cf">
					<div class="row">
						<div class="am-u-sm-12 am-u-md-12 am-u-lg-9">
                            <div class="page-header-heading"><span class="am-icon-home page-header-heading-icon"></span> 检测{{ status }}结果查看 <small>共<strong style="color: yellowgreen;font-size: larger">{{ result }}</strong>条数据</small></div>
							<p class="page-header-description">目前只支持HTTP检测。</p>
						</div>
				</div>


                 <div class="row  am-cf">
                    <div class="am-u-sm-12 am-u-md-12 am-u-lg-12 widget-margin-bottom-lg">
							<div class="widget am-cf widget-body-lg" style="margin-top: 50px">

								<div class="widget-body  am-fr">
									<div class="am-scrollable-horizontal ">
										<table width="100%" class="am-table am-table-compact am-text-nowrap tpl-table-black " >
											<thead>
												<tr>
													<th style="font-size: 16px">COOKIE</th>
													<th style="font-size: 16px">请求头信息</th>
                                                    <th style="font-size: 16px">操作</th>
												</tr>
											</thead>
											<tbody>
                                            {% for hh in users.object_list %}
                                                {% if hh.origin_cookie == '' %}
                                                <tr class="gradeX" style="width:200px; height:50px;">
                                                    <td id="cookie"><pre>None</pre> </td>
                                                    <td id="changbr"><pre>{{ hh.request_header }}</pre></td>
                                                    <td> <div>
                                                             <button type="button" class="am-btn am-btn-primary tpl-btn-bg-color-success " onclick="gethea()">打开网页</button>
                                                    </div></td>
                                                </tr>
                                                {% else %}
                                                <tr class="gradeX" style="width:200px; height:50px;">
                                                    <td id="cookie"><pre>{{ hh.origin_cookie }}</pre> </td>
                                                    <td id="changbr"><pre>{{ hh.request_header }}</pre></td>
                                                    <td> <div>
                                                             <button type="button" class="am-btn am-btn-primary tpl-btn-bg-color-success " onclick="gethea()">打开网页</button>
                                                    </div></td>
												</tr>
                                                {% endif %}
                                            {% endfor %}
												<!-- more data -->
											</tbody>
										</table>
                                    <nav aria-label="Page navigation" style="margin-left: 300px">
                                        <div>
                                        <ul class="pagination">
                                                {% if users.has_previous %}
                                                    <li>
                                                    <a class="type-vale" href="?page=1&type={{ type }}&sort={{ sort }}&catas={{ cata }}" aria-label="Previous"><span aria-hidden="true">首页</span></a>
                                                    </li>
                                                    <li>
                                                    <a class="type-vale" href="?page={{ users.previous_page_number }}&type={{ type }}&sort={{ sort }}&catas={{ cata }}" aria-label="Previous"><span aria-hidden="true">&laquo;</span></a>
                                                    </li>
                                                {% endif %}

                                               {% for pg in users.paginator.pager_num_range %}
                                                {% if pg == users.number %}
                                                <li class="active"><a class="type-vale" href="?page={{ pg }}&type={{ type }}&sort={{ sort }}&catas={{ cata }}">{{ pg }}</a></li>
                                                {% else %}
                                                <li><a class="type-vale" href="?page={{ pg }}&type={{ type }}&sort={{ sort }}&catas={{ cata }}">{{ pg }}</a></li>
                                                {% endif %}
                                                {% endfor %}
                                                {% if users.has_next %}
                                                    <li>
                                                        <a class="type-vale" href="?page={{ users.next_page_number }}&type={{ type }}&sort={{ sort }}&catas={{ cata }}" aria-label="Next"><span aria-hidden="true">&raquo;</span></a></li>
                                                    <li>
                                                        <a class="type-vale" href="?page={{ users.paginator.num_pages }}&type={{ type }}&sort={{ sort }}&catas={{ cata }}" aria-label="Next"><span aria-hidden="true">尾页</span></a></li>
                                                {% endif %}
                                        {% if result > 10 %}
                                            <li>
                                            <form  action="{% url "search_action" cata %}" method="post" style="margin-left: 800px">
                                                        {% csrf_token %}
                                                    <input  type="text"  placeholder="页数" name="stuff" style="height: 35px;width: 50px;color: black;">
                                                        <button type="submit" style="display: none"></button>
                                                <span style="font-size: 20px;margin-left: 30px">{{ users.number }} /{{ users.paginator.num_pages }}</span>
                                                    </form>
                                        </li>
                                            {% else %}
                                        {% endif %}

                                            </ul>
                                         </div>
                                            </nav>
                                    </div>
								</div>
							</div>

						</div>
					</div>
        {% endblock %}
{% block js %}
    changeurl();
    function changeurl(){
        var xsxf = document.getElementById("changbr");
        xsxf.innerHTML =  xsxf.innerHTML.replace('Accept-Language', '\nAccept-Language');
        xsxf.innerHTML =  xsxf.innerHTML.replace('Referer', '\nReferer');
        xsxf.innerHTML =  xsxf.innerHTML.replace('X-Requested-With', '\nX-Requested-With');
        xsxf.innerHTML =  xsxf.innerHTML.replace('Accept-Encoding', '\nAccept-Encoding');
        xsxf.innerHTML =  xsxf.innerHTML.replace('Host', '\nHost');
        xsxf.innerHTML =  xsxf.innerHTML.replace('Accept', '\nAccept');
        xsxf.innerHTML =  xsxf.innerHTML.replace('User-Agent', '\nUser-Agent');
        xsxf.innerHTML =  xsxf.innerHTML.replace('Pragma', '\nPragma');
        xsxf.innerHTML =  xsxf.innerHTML.replace('Cookie', '\nCookie');
        xsxf.innerHTML =  xsxf.innerHTML.replace('Origin', '\nOrigin');
        xsxf.innerHTML =  xsxf.innerHTML.replace('Content-Type', '\nContent-Type');
        xsxf.innerHTML =  xsxf.innerHTML.replace('Cache-Control', '\nCache-Control');
        xsxf.innerHTML =  xsxf.innerHTML.replace('X-Forwarded-For', '\nX-Forwarded-For');
        xsxf.innerHTML =  xsxf.innerHTML.replace('Connection', '\nConnection');
        xsxf.innerHTML =  xsxf.innerHTML.replace('Content-Length', '\nContent-Length');
        xsxf.innerHTML =  xsxf.innerHTML.replace('If-Modified-Since', '\nIf-Modified-Since');
         };
    function gethea() {
        var cookies = $('#cookie').html();
        var request_headers = $('#changbr').html();
            $.ajax({
                url: '{% url "getheader" red sed  %}',
                type: 'POST',
                data: {cookie: cookies, request_header: request_headers},
                success:function (callback) {
                    var callback_dict = $.parseJSON(callback);
                    document.write(callback_dict);
                    }
                })
                };
{% endblock %}
    function openwebpage(value) {
            $.ajax({
                url: value.host,
                type: 'GET',
                headers:{
                    'Content-Length': value.Content-Length, 'Connection': value.Connection, 'X-Forwarded-For': value.X-Forwarded-For,
                    'Cache-Control': value.Cache-Control, 'Cookie': value.Cookie, 'Pragma': value.Pragma, 'User-Agent': value.User-Agent,
                    'Accept': value.Accept, 'Accept-Encoding': value.Accept-Encoding, 'Referer':value.Referer,'Accept-Language':value.Accept-Language,
                    'If-Modified-Since': value.If-Modified-Since,'X-Requested-With': value.X-Requested-With
                    }
                })
                };
    function openwebpage(value) {
            $.ajax({
                type:"GET",
                url:"http://" + value.Host,
                dataType:"jsonp",
                jsonpCallback:"cb",
                success:function(){
                    }
            })
                };